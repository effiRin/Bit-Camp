# 0401 수업 - DB 관련

<br>

# 1. 데이터베이스

### 1-1. 데이터베이스 종류

- **관계형(RDBMS) 데이터 베이스**
    - 정통적으로 많이 쓰이는 데이터 베이스
    - Oracle / DB2(금융권 기업) / MySQL / MariaDB / PostgreSQL 등  
<br>
- **ETC - NoSQL (Not only SQL)**
    - SQL 계열 쿼리 언어를 사용할 수 있다는 사실을 강조한다는 점에서 “Not only SQL”이라고 불리기도 한다.
    - 원래 의미는 NoSQL(non SQL 또는 non relational) 데이터베이스
    - 단순 검색 및 추가 작업을 위한 매우 최적화된 키값 저장 공간
    - NoSQL 데이터베이스에 쓰이는 자료구조들은 관계형 데이터베이스 테이블보다 더 유연하고, 속도가 빠른 편이기도.
    

### 1-2. 데이터베이스 영역

- 관리 / 운영 - 데이터베이스 설정, 백업, 복구
- 개발 - 설정

<br>

---
# 2. SQL

- Structure Query Language (구조화된 질의 언어 → 중첩된 구조를 만들 수 있다)  

### 2-1. SQL 문법 종류

1. DDL (Data Define Language) - 데이터 정의 언어   
데이터베이스(오브젝트)를 정의

1. DCL (Data Control Language) - 데이터 제어 언어

1. DML (Data Manipulation Language) - 데이터 조작 언어  
데이터를 핸들링하는 언어 → 주로 insert, delete, update 작업을 한다.

<br>

+ Query : 
데이터를 조회하는 SQL은 흔히 쿼리(query)라고 하며, 주로 select를 이용해서 작성.  

<br>

### 2-2. 쿼리 3가지 → DML의 성격

| 데이터 핸들링 | 객체 정의 | 조회 |
| --- | --- | --- |
| insert | create | select |
| update | drop |  |
| delete | grant |  |
<br>
- 쿼리의 80~90%는 ‘조회’ 작업
- **객체 정의는 ‘설계 단계’에서 무조건 끝나야 하고,** 
실제로 **개발 단계**에서 하는 것은 **‘데이터 핸들링과 조회’**가 되어야만 한다.

<br>

### 2-3. SQL 명령어

- INSERT, DELETE, UPDATE → 숫자가 반환된다는 공통점
 (몇 개가 추가되고, 삭제되고, update 되느냐)

- SELECT
    - 부분 + 로딩 / 추가적인 로딩이 걸림
    - SELECT를 보내면 DB가 쿼리를 분석하고, 분석한 결과를 바탕으로 실행 계획을 세운다.
    
<br>
<br>

---

# 3. 테이블

- **‘record / row / 튜플 / 개체’ 특징**
1. ‘도메인’에 해당됨
2. ‘식별자’가 있다. (PK, Primary Key)  
    a. ‘직접 지정’ 방식  
    예1) 회원가입 - 아이디 중복 검사 (식별자가 unique 해야 함)  
    예2) 탈퇴 후 같은 아이디로 가입 불가 
    <br> 
   
    b. ‘자동 지정’ 방식  
    - 중복만 없도록** 자동 지정 
    - 대표적으로 **‘시퀀스’** / auto_increment 등

<br>

- **테이블 스페이스** : 모인 테이블을 묶어주는 공간

<br>

# 4. nextval, currval

```sql
select * from tab;
create sequence seq_todo; // 시퀀스 만들기 (딱 1번뿐)

select seq_todo.nextval from dual;  // (dual은 dummy 테이블)
select seq_todo.currval from dual;
```

- **nextval : 해당 시퀀스의 다음 값을 불러오는다.**
- **currval : 현재 시퀀스를 알고 싶을 때**
- **commit : 메모리상에서 변경한 내용을 실제 DB에 반영하는 것**

- 시퀀스 - unique한 값 만들어낼 때 쓴다 / 보통 primary key를 만들때 이용
- **처음에 시퀀스 만들 때는 무조건 nextval이고,**
시퀀스를 쓸 때는 currval이 아니라 nextval 위주로 써야한다.


<br>

- 값 넣기

```sql
select * from tbl_todo;

insert into TBL_TODO (tno, TEXT)
values (SEQ_TODO.nextval, 'AAA'|| SEQ_TODO.currval);
```

<br>

- 개수 세기 / 더미 데이터 채우기 반복

```jsx
select count(*) from tbl_todo;

insert into TBL_TODO (tno, text)
(select SEQ_TODO.nextval, 'AAA'|| SEQ_TODO.currval from TBL_TODO);
```

<br>

# 5. 데이터 ‘정렬’

```jsx
select count(*) from tbl_todo;

insert into TBL_TODO (tno, text)
(select SEQ_TODO.nextval, 'AAA'|| SEQ_TODO.currval from TBL_TODO);

select * from tbl_todo order by tno + 1 desc; // 인식을 못하게 
```

- 데이터베이스 오래 걸리는 작업 → ‘정렬, 검색’
- 더 빨리 처리하는 방법 → Primary Key를 만든다.

<br>

### Explain Plan


![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cb96fa36-fbfd-4ed7-bc62-a102a716cfac/Untitled.png)

- 해당 SQL문 - 우클릭 - Explain Plan
- 해당 SQL문을 데이터베이스에서 어떻게 처리하는지 보여주는 기능
- 안쪽에서 바깥쪽으로 본다.

```jsx
select count(*) from tbl_todo;

insert into TBL_TODO (tno, text)
(select SEQ_TODO.nextval, 'AAA'|| SEQ_TODO.currval from TBL_TODO);

select * from tbl_todo order by tno desc;
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8a63d335-33e7-44e7-8b83-fc5722b2150d/Untitled.png)

- **Balance Tree**